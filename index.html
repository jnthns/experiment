<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>Experiment Test Environment</title>
        <!-- Favicon-->
        <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="css/styles.css" rel="stylesheet" />
        <script src="https://unpkg.com/amplitude-js"></script>
        <script src="https://unpkg.com/@amplitude/experiment-js-client@1.4.0/dist/experiment.umd.js"></script>
        <script src="js/analytics.js"></script>
    </head>
    <body>
        <div class="d-flex" id="wrapper">
            <!-- Sidebar-->
            <div class="border-end bg-white" id="sidebar-wrapper">
                <div class="sidebar-heading border-bottom bg-light">Sidebar</div>
                <div class="list-group list-group-flush">
                    <a class="list-group-item list-group-item-action list-group-item-light p-3" href="./routes/landingpage.html">Landing Page</a>
                   <!--  <a class="list-group-item list-group-item-action list-group-item-light p-2" id='previousAnalyticsKey'>Previous Analytics Key</a>
                    <a class="list-group-item list-group-item-action list-group-item-light p-2" id='previousUserId'>Overview</a>
                    <a class="list-group-item list-group-item-action list-group-item-light p-2" href="#!">Events</a>
                    <a class="list-group-item list-group-item-action list-group-item-light p-2" href="#!">Profile</a>
                    <a class="list-group-item list-group-item-action list-group-item-light p-2" href="#!">Status</a> -->
                </div>
            </div>
            <!-- Page content wrapper-->
            <div id="page-content-wrapper">
                <!-- Top navigation-->
                <nav class="navbar navbar-expand-lg navbar-light bg-light border-bottom">
                    <div class="container-fluid">
                        <button class="btn btn-primary" id="sidebarToggle">Toggle Sidebar</button>
                        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
                        <div class="collapse navbar-collapse" id="navbarSupportedContent">
                            <ul class="navbar-nav ms-auto mt-2 mt-lg-0">
                                <li class="nav-item active"><a class="nav-link" href="/">Â© Jon Shek</a></li>
                               <!--  <li class="nav-item"><a class="nav-link" href="#!">Link</a></li>
                                <li class="nav-item dropdown">
                                    <a class="nav-link dropdown-toggle" id="navbarDropdown" href="#" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Dropdown</a>
                                    <div class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdown">
                                        <a class="dropdown-item" href="#!">Action</a>
                                        <a class="dropdown-item" href="#!">Another action</a>
                                        <div class="dropdown-divider"></div>
                                        <a class="dropdown-item" href="#!">Something else here</a>
                                    </div>
                                </li> -->
                            </ul>
                        </div>
                    </div>
                </nav><br>
                <!-- Page content-->
                <div class="container-fluid">
                    <h1>Experiment Test Environment</h1>
                    <p>Test your experiment or flag by filling out the fields below. You'll receive the raw responses from Amplitude at the bottom of the page.</p>
                    <div>
                        <div class="col-md-8">
                            <table id="savedInfo" class="table table-bordered">
                              <thead>
                                <tr>
                                  <th scope="col">Previously Used Info</th>
                                </tr>
                              </thead>
                              <tbody>
                                <tr>
                                  <td>Analytics API Key</td>
                                  <td id='savedApiKey'>Will appear here if saved</td>
                                </tr>
                                <tr>
                                  <td>Deployment Key</td>
                                  <td id='savedExpKey'>Will appear here if saved</td>
                                </tr>
                                <tr>
                                  <td>Experiment Flag Key</td>
                                  <td id='savedFlagKey'>Will appear here if saved</td>
                                </tr>
                                <tr>
                                  <td>User ID</td>
                                  <td id='savedUserId'>Will appear here if saved</td>
                                </tr>
                                <tr>
                                  <td>Device ID</td>
                                  <td id='savedDeviceId'>Will appear here if saved</td>
                                </tr>
                              </tbody>
                            </table>
                        </div>
                        <hr>
                        <h3 class="mt-4">Analytics Configuration</h3>
                        <p>Enter your Analytics API Key and your User ID. If you don't set a User ID here, you will need to set a Device ID below. The User ID that you set here will also be passed to Experiment. You can also change the user ID and init again, which will restart the instance with the new user ID if you want to fetch for a different user. Note that a new device ID will be auto-generated for a new user ID if you don't set one below.</p>
                      <div class="form-row align-items-center">
                        <div class="col-sm-4 my-1">
                          <b><label class="sr-only" for="inlineFormInputGroupUsername">Analytics API Key</label></b>
                          <input type="text" class="form-control" id="analyticsKey">
                        </div>
                        <div class="col-sm-4 my-1">
                          <b><label class="sr-only" for="inlineFormInputGroupUsername">User ID</label></b>
                          <div class="input-group">
                            <input type="text" class="form-control" id="userId">
                          </div>
                        </div>
                        <br>
                        <div class="col-auto my-1">
                          <button class="btn btn-info" id="analyticsInit">Initialize Analytics</button>
                        </div><br>
                        <p id='analyticsLoadMessage' style='color: green'></p>
                    </div><hr>
                    <div>
                        <h3 class="mt-4">Experiment Configuration</h3>
                        <p>Enter your information below for the Experiment you want to test. Once you hit the button below, Experiment will initialize.</p>
                      <div class="form-row align-items-center">
                        <div class="col-sm-4 my-1">
                          <b><label class="sr-only" for="inlineFormInputGroupUsername">Deployment Key</label></b>
                          <input type="text" class="form-control" id="deploymentKey" placeholder="Must be Client key">
                        </div>
                        <div class="col-sm-4 my-1">
                          <b><label class="sr-only" for="inlineFormInputGroupUsername">Experiment/Flag Key</label></b>
                          <div class="input-group">
                            <input type="text" class="form-control" id="flagKey">
                          </div>
                        </div>
                        <div class="col-sm-3 my-1">
                          <b><label class="sr-only" for="inlineFormInputGroupUsername">Device ID (Optional)</label></b>
                          <div class="input-group">
                            <input type="text" class="form-control" id="deviceId">
                          </div>
                        </div>
                        <div class="col-sm-8 my-1">
                          <b><label class="sr-only" for="inlineFormInputGroupUsername">Contextual User Properties (Optional)</label></b>
                          <div class="input-group">
                            <input type="text" class="form-control" id="userProperties" placeholder='Must enter as JSON i.e. {"plan":"premium"}'>
                          </div>
                        </div>
                        <br>
                        <div class="col-auto my-1">
                          <button class="btn btn-primary" id="onKeySubmit">Initialize Experiment</button>
                        </div><br>
                        <p id='loadMessage' style='color: green'></p>
                        <pre id='idCheck' style='color: blue'></pre>
                        <script src='js/experiment.js'></script>
                      </div>
                    </div>
                    <hr/>
                    <h3 class="mt-4">Test your Experiment</h3>
                    <p>First make sure your Experiment is activated for the Deployment you set!<br>
                        Fetch when all of the above is filled out, which will generate an Assignment event and return a response which will display below.<br>
                        After fetch, you can hit Fetch to access the Variant value and payload.<br>
                        Finally, you can hit Exposure to generate the Exposure event in your Analytics instance.
                        <br><br>
                        If you want to simulate a multiple page flow, like an onboarding funnel, you can fetch on this page first then hit Next Page, where you can fetch again with new properties.  
                    </p>
                    <p>
                        <button class='btn btn-success experiment'>Fetch</button>
                        <button class='btn btn-danger experiment'>Variant</button>
                        <button class='btn btn-warning experiment'>Exposure</button>
                        <button class='btn btn-warning experiment' onclick='landingPage();'>Next Page</button>
                        <pre style="color:green;" id="displayResponse">Response displayed here</pre>
                    </p>
                    <br>
                </div>
            </div>
        </div>
        <!-- Bootstrap core JS-->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js"></script>
    </body>
</html>
